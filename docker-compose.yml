services:
  easy-proxies:
    image: ghcr.io/jasonwong1991/easy_proxies:latest
    container_name: easy-proxies
    restart: unless-stopped
    env_file:
      - ./.env
    # 方式一：使用主机网络模式（推荐，支持端口自动重分配）
    network_mode: host
    # 方式二：手动映射端口（注释掉 network_mode，启用下面的 ports）
    # ports:
    #   # Pool 模式入口（pool/hybrid 模式使用）
    #   - "2323:2323"
    #   # Web 监控面板
    #   - "9091:9091"
    #   # Multi-port 端口范围（multi-port/hybrid 模式使用，根据节点数量调整）
    #   - "24000-24200:24000-24200"
    #
    # 支持的运行模式（通过环境变量或数据库运行时配置）：
    #   - pool: 单端口代理池，所有节点共享 2323 端口
    #   - multi-port: 多端口模式，每个节点独立端口
    #   - hybrid: 混合模式，同时启用 pool (2323) + multi-port (24000+)
    #
    # hybrid 模式说明：
    #   - 代理池入口：http://0.0.0.0:2323（自动负载均衡）
    #   - 独立节点入口：http://0.0.0.0:24000, 24001, ...（直连特定节点）
    #   - 节点状态在两种入口间共享（黑名单同步）
    #   - 端口冲突时自动重分配到下一个可用端口
    # 可选：如需文件方式引导节点，可挂载 nodes.txt 并设置 NODES_FILE=/var/lib/easy-proxies/nodes.txt
    # volumes:
    #   - ./nodes.txt:/var/lib/easy-proxies/nodes.txt
